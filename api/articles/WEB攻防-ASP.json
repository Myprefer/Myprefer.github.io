{"title":"WEB攻防-ASP","uid":"97fee6b67736877d6288cc0bb76734de","slug":"WEB攻防-ASP","date":"2024-03-03T06:48:26.000Z","updated":"2024-03-03T08:46:21.446Z","comments":true,"path":"api/articles/WEB攻防-ASP.json","keywords":null,"cover":null,"content":"<h3 id=\"ASP安全\"><a href=\"#ASP安全\" class=\"headerlink\" title=\"ASP安全\"></a>ASP安全</h3><ul>\n<li>常用组合: windows+IIS+ASP+Access(sql server)</li>\n</ul>\n<h4 id=\"安全问题\"><a href=\"#安全问题\" class=\"headerlink\" title=\"安全问题:\"></a>安全问题:</h4><h5 id=\"MDB默认下载\"><a href=\"#MDB默认下载\" class=\"headerlink\" title=\"MDB默认下载\"></a>MDB默认下载</h5><ul>\n<li>access数据库文件后缀名一般为asp&#x2F;asa&#x2F;mdb</li>\n<li>其中, 浏览器访问asp&#x2F;asa文件时, 文件会被解析执行, 访问mdb文件时会下载该文件</li>\n<li>由此可以获取站点敏感数据</li>\n</ul>\n<h5 id=\"ASP后门植入连接\"><a href=\"#ASP后门植入连接\" class=\"headerlink\" title=\"ASP后门植入连接\"></a>ASP后门植入连接</h5><ul>\n<li><p>留言板写入一句话木马:</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #babed8\">┼攠數畣整爠煥敵瑳∨≡┩愾</span></span></code></pre></div><ul>\n<li>密码为a</li>\n</ul>\n</li>\n<li><p>原理: 网站开启了asp解析，直接访问数据库文件会返回信息，写入一句话木马后进行连接</p>\n</li>\n</ul>\n<h5 id=\"IIS短文件名探针安全漏洞\"><a href=\"#IIS短文件名探针安全漏洞\" class=\"headerlink\" title=\"IIS短文件名探针安全漏洞\"></a>IIS短文件名探针安全漏洞</h5><ul>\n<li>原理: <ul>\n<li>Windows系统为了兼容16位MS-DOS程序，为文件名较长的文件和文件夹生成了对应的Windows 8.3短文件名。比如文件名direct~1.asp中间有一个波浪号，这种就是短文件名了</li>\n</ul>\n</li>\n<li>利用:<ul>\n<li>使用脚本扫描网站目录造成敏感信息泄露（不同于使用字典扫描）</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"中间件IIS文件上传解析\"><a href=\"#中间件IIS文件上传解析\" class=\"headerlink\" title=\"中间件IIS文件上传解析\"></a>中间件IIS文件上传解析</h5><ul>\n<li><p>流程：发现网站存在上传点–上传asp木马–若存在文件名监测通过修改文件类型绕过检测–shell工具连接</p>\n</li>\n<li><p>1.jpg文件无法解析，修改为1.asp;.jpg即可绕过。或者1.jpg文件放在a.asp文件下也可进行解析</p>\n</li>\n</ul>\n<h5 id=\"IIS配置目录读写\"><a href=\"#IIS配置目录读写\" class=\"headerlink\" title=\"IIS配置目录读写\"></a>IIS配置目录读写</h5><ul>\n<li>当网站为IIS6.0且开启写入权限、开启web服务拓展WebDAV则存在此漏洞</li>\n</ul>\n<h6 id=\"put攻击\"><a href=\"#put攻击\" class=\"headerlink\" title=\"put攻击\"></a>put攻击</h6><ul>\n<li>put协议，当我们浏览某个网站，访问某个资源时，如果网站存在这个资源，则会进行替换，若网站不存在这个资源，则会创建这个资源</li>\n<li>可以用工具利用put直接写shell  (桂林老兵)</li>\n</ul>\n","feature":true,"text":"ASP安全 常用组合: windows+IIS+ASP+Access(sql server) 安全问题:MDB默认下载 access数据库文件后缀名一般为asp...","permalink":"/post/WEB攻防-ASP","photos":[],"count_time":{"symbolsCount":681,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":20,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":20,"path":"api/tags/学习日志.json"},{"name":"小迪安全","slug":"小迪安全","count":8,"path":"api/tags/小迪安全.json"},{"name":"WEB攻防","slug":"WEB攻防","count":3,"path":"api/tags/WEB攻防.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ASP%E5%AE%89%E5%85%A8\"><span class=\"toc-text\">ASP安全</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98\"><span class=\"toc-text\">安全问题:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#MDB%E9%BB%98%E8%AE%A4%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">MDB默认下载</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#ASP%E5%90%8E%E9%97%A8%E6%A4%8D%E5%85%A5%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\">ASP后门植入连接</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#IIS%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D%E6%8E%A2%E9%92%88%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">IIS短文件名探针安全漏洞</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E4%B8%AD%E9%97%B4%E4%BB%B6IIS%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90\"><span class=\"toc-text\">中间件IIS文件上传解析</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#IIS%E9%85%8D%E7%BD%AE%E7%9B%AE%E5%BD%95%E8%AF%BB%E5%86%99\"><span class=\"toc-text\">IIS配置目录读写</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#put%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">put攻击</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Myprefer","slug":"blog-author","avatar":"https://i0.imgs.ovh/2024/01/23/x3DH5.jpeg","link":"https://myprefer.github.io/","description":"An ordinary learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"PHP开发","uid":"1f592da3647b8088a97f7f44683fed82","slug":"PHP开发","date":"2024-02-28T10:59:34.000Z","updated":"2024-03-03T08:46:43.937Z","comments":true,"path":"api/articles/PHP开发.json","keywords":null,"cover":null,"text":"文件操作文件上传php&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;mu...","permalink":"/post/PHP开发","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"9 mins."},"categories":[],"tags":[{"name":"网络安全","slug":"网络安全","count":20,"path":"api/tags/网络安全.json"},{"name":"学习日志","slug":"学习日志","count":20,"path":"api/tags/学习日志.json"},{"name":"小迪安全","slug":"小迪安全","count":8,"path":"api/tags/小迪安全.json"},{"name":"PHP开发","slug":"PHP开发","count":1,"path":"api/tags/PHP开发.json"}],"author":{"name":"Myprefer","slug":"blog-author","avatar":"https://i0.imgs.ovh/2024/01/23/x3DH5.jpeg","link":"https://myprefer.github.io/","description":"An ordinary learner","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}